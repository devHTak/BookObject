#### 메시지와 인터페이스

##### 협력과 메시지

- 클라이언트-서버 모델
  - 협력은 어떤 객체가 다른 객체에게 무언가를 요구할 때 시작하며 메시지는 객체 사이의 협력을 가능하게 하는 메개체이다.
  - 협력 안에서 메시지를 전송하면 클라이언트, 메시지를 수신하는 객체를 서버라고 한다.
- 메시지와 메시지 전송
  - 메시지는 객체들이 협력하기 위해 사용할 수 있는 의사소통 수단
  - 메시지는 오퍼레이션명, 인자로 구성되며 메시지 전송은 메시지 수신자(객체)를 추가한 것이다.
    ```java
    discountCondition.isSatisfiedBy(screening);
    //  수신자.오퍼레이션명(..인자);
    ```
- 메시지와 메서드
  - 메시지를 수신했을 때 실제로 어떤 코드가 실행되는 지는 메시지 수신자의 실제 타입이 무엇인가에 따라 달려있다.
  - 메시지를 수신했을 때 실제로 실행되는 함수 또는 프로시저를 메서드라고 한다.
  - 메시지와 메서드에 구분
    - 메시지 수신자 타입에 따라 실행되는 메서드가 다르다(다형성)
    - 메시지와 메서드라는 서로 다른 개념을 실행 시점에 연결해야 하기 때문에 컴파일 시점과 실행 시점의 의미가 달라질 수 있다.
    - 즉, 메시지와 메서드를 구분함으로써 메시지 전송자와 수신자가 느슨하게 결합될 수 있게 한다.
- 퍼블릭 인터페이스와 오퍼레이션
  - 객체가 외부 소통을 위해 공개하는 메시지 집합을 퍼블릭 인터페이스라 한다.
  - 퍼블릭 인터페이스에 포함된 메시지를 오퍼레이션이라 한다.
    - 오퍼레이션은 수행 가능한 어떤 행동에 대한 추상화이며, 내부의 구현 코드는 제외하고 단순히 메시지와 관련된 시그니처를 가리키는 경우가 대부분이다.
  - 그에 비해 메시지를 수신했을 때 실제로 실행되는 코드는 메서드라고 부른다.
- 시그니처
  - 오퍼레이션이나 메서드의 명세를 나타낸 것으로 이름과 인자의 목록을 포함한다

##### 인터페이스 설계 품질
- 최소한의 인터페이스와 추상적인 인터페이스
  - 책임주도설계 방법은 메시지를 먼저 선택함으로써  협력과는 무관한 오퍼레이션이 인터페이스에 스며드는 것을 방지한다.
- 퍼블릭 인터페이스의 품질에 영향을 미치는 원칙
  - 디미터 법칙
  - 묻지말고 시켜라
  - 의도를 드러내는 인터페이스
  - 명령 - 쿼리 분리

- 디미터 법칙
  - 객체의 내부 구조에 대한 결합으로 인해 발생하는 설계 문제를 해결하기 위해 제안된 원칙
  - 객체의 내부 구조에 강하게 결합되지 않도록 협력 경로를 제한하라
  - 클래스가 특정한 조건을 만족하는 대상에게만 메시지를 전송하도록 프로그래밍 해야 한다.
    - 모든 클래스 C와 C에 구현된 모든 메서드 M에 대해서, M이 메시지를 전송할 수 있는 모든 객체는 아래와 같은 클래스의 인스턴스여야 한다.
      - M의 인자로 전달된 클래스(C자체 포함)
      - C의 인스턴스 변수의 클래스
    - 위에 말이 어렵다면 아래 조건을 만족하는 인스턴스에만 메시지를 전송하도록 하자
      - this
      - 메서드의 매개변수
      - this의 속성
      - this의 속성인 컬렉션의 요소
      - 메서드 내에서 생성된 지역 객체

- 묻지말고 시켜라
  - 디미터 법칙은 훌륭한 메시지는 객체의 상태에 관해 묻지 않고, 원하는 것을 시켜야 한다는 것을 강조
  - 묻지말고 시켜라는 이런 스타일의 메시지 작성을 장려하는 원칙을 가리키는 용어
  - 내부의 상태를 묻는 오퍼레이션을 인터페이스에 포함시키고 있다면 더 나은 방법이 없는지 고민하라
    - 상태를 묻는 것이 아닌 행동을 요청하는 인터페이스를 만들어라

- 의도를 드러내는 인터페이스
  - 메서드 명명하는 두가지 방법
    - 메서드가 작업을어떻게 수행하는지를 나타내자(구현방법)
    - 어떻게가 아닌 무엇을 하는지를 드러내자
      - 무엇을 하는지를 드러내면 클라이언트 입장에서 동일한 작업을 수행하는 메서드들을 하나의 타입 계층으로 묶을 수 있는 가능성이 커진다.
      - 의도를 드러내는 선택자라고 부른다. (Intention Revealing Selector)

##### 원칙의 법칙

- 설계 원칙은 트레이드오프의 산물이므로 현재 상황에 부적합하다면 과감하게 무시해야 한다.

- 디미터 법칙은 하나의 도트(.)를 강제하는 규칙이 아니다.
  - 디미터 법칙은 결합도와 관련된 것으로 결합도가 문제가 되는 것은 객체의 내부구조가 외부에 노출되는 경우로 한정된다
  
- 결합도와 응집도의 충돌
  - 일반적으로 어떤 객체의 상태를 물어본 후 반환된 상태를 기반으로 결정을 내리고, 결정에 따라 객체의 상태를 변경한다면, 묻지말고 시켜라 스타일로 변경해야 한다.
  - 맹목적으로 위임 메서드를 추가하면 같은 퍼블릭 인터페이스 안에 어울리지 않는 오퍼레이션들이 공존하게 된다
  - 결과적으로 객체는 상관없는 책임들을 떠안게 되어 응집도가 낮아진다.
  - 가끔씩은 묻는 것 외에 다른 방법이 존재하지 않을 수 있다

##### 명령-쿼리 분리 원칙
  
- 객체의 상태를 수정하는 오퍼레이션을 명령이라고 부르고, 객체와 관련된 정보를 반환하는 오퍼레이션을 쿼리라고 한다.
- 명령-쿼리 분리 원칙은 퍼블릭 인터페이스에 오퍼레이션을 정의할 때 참고할 수 있는 지침을 제공한다.
  - 객체의 상태를 변경하는 명령은 반환값을 가질 수 없다.
  - 객체의 정보를 반환하는 쿼리는 상태를 변경할 수 없다.
